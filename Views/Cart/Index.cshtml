@model IList<COM5005.Web.Models.CartItem>
@{
    ViewBag.Title = "Sepet";
    Layout = "~/Views/Shared/_Layout.cshtml";
    decimal total = Model.Sum(x => x.Price * x.Quantity);
}
<h1>Sepet</h1>
@if(!Model.Any()){
  <div class="alert alert-info">Sepetiniz boş.</div>
}else{
  <div class="table-responsive">
    <table class="table align-middle">
      <thead><tr><th>Ürün</th><th>Adet</th><th>Birim</th><th>Ara Toplam</th><th></th></tr></thead>
      <tbody>
      @foreach(var x in Model){
        <tr>
          <td>@Html.Raw(x.Emoji) @x.Name</td>
          <td class="d-flex gap-2">
            @using(Html.BeginForm("Decr","Cart", FormMethod.Post)){ @Html.Hidden("id", x.ProductId) <button class="btn btn-outline-secondary">-</button> }
            <input class="form-control" style="width:80px" value="@x.Quantity" readonly />
            @using(Html.BeginForm("Incr","Cart", FormMethod.Post)){ @Html.Hidden("id", x.ProductId) <button class="btn btn-outline-secondary">+</button> }
          </td>
          <td>@x.Price.ToString("C")</td>
          <td>@(x.LineTotal.ToString("C"))</td>
          <td>@using(Html.BeginForm("Remove","Cart", FormMethod.Post)){ @Html.Hidden("id", x.ProductId) <button class="btn btn-outline-danger">Sil</button> }</td>
        </tr>
      }
      </tbody>
      <tfoot><tr><th colspan="3" class="text-end">Toplam</th><th>@total.ToString("C")</th><th></th></tr></tfoot>
    </table>
  </div>
  <div class="d-flex justify-content-end gap-2">
    @using(Html.BeginForm("Clear","Cart", FormMethod.Post)){ <button class="btn btn-outline-danger">Sepeti Temizle</button> }
    <a class="btn btn-primary" href="@Url.Action("Index","Checkout")">Ödemeye Geç</a>
  </div>
}
